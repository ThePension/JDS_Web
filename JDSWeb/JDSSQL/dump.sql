DROP TABLE IF EXISTS Role;
DROP TABLE IF EXISTS [User];
DROP TABLE IF EXISTS ClothType;
DROP TABLE IF EXISTS ClothSize;
DROP TABLE IF EXISTS ClothColor;
DROP TABLE IF EXISTS Cloth;
DROP TABLE IF EXISTS Event;
DROP TABLE IF EXISTS Image;
DROP TABLE IF EXISTS ShopGallery;
DROP TABLE IF EXISTS EventGallery;

CREATE TABLE ClothType (
	Id INT PRIMARY KEY NOT NULL,
	Name VARCHAR(50) NOT NULL,
	Price DECIMAL(6,2) NOT NULL
);

CREATE TABLE ClothSize (
	Id INT PRIMARY KEY NOT NULL,
	Name VARCHAR(50) NOT NULL,
	Shortcut VARCHAR(10) NOT NULL
);

CREATE TABLE ClothColor (
	Id INT PRIMARY KEY NOT NULL,
	Name VARCHAR(50) NOT NULL,
	Hexa VARCHAR(7) NOT NULL
);

CREATE TABLE Cloth (
	Id INT IDENTITY(1,1) NOT NULL,
	Type INT NOT NULL,
	Size INT NOT NULL,
	Color INT NOT NULL,
	Name VARCHAR(50) NOT NULL,
	Description VARCHAR(100) NOT NULL,
	PRIMARY KEY(Id),
	FOREIGN KEY (Type)
		REFERENCES ClothType(Id)
		ON UPDATE CASCADE
		ON DELETE CASCADE,
	FOREIGN KEY (Size)
		REFERENCES ClothSize(Id)
		ON UPDATE CASCADE
		ON DELETE CASCADE,
	FOREIGN KEY (Color)
		REFERENCES ClothColor(Id)
		ON DELETE CASCADE
		ON UPDATE CASCADE
);

CREATE TABLE Role (
	Id INT PRIMARY KEY NOT NULL,
	Name VARCHAR(20) NOT NULL
);

CREATE TABLE [User] (
	Id INT IDENTITY(1,1) NOT NULL,
	Role INT NOT NULL,
	Username VARCHAR(50) NOT NULL,
	Email VARCHAR(50) NOT NULL,
	Password VARCHAR(100) NOT NULL,
	Newsletter BIT NOT NULL,
	PRIMARY KEY (Id),
	FOREIGN KEY (Role)
		REFERENCES Role(Id)
		ON UPDATE CASCADE
		ON DELETE CASCADE
);

CREATE TABLE Event (
	Id INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
	Date DATETIME NOT NULL,
	Title VARCHAR(100) NOT NULL,
	Description VARCHAR(500) NOT NULL
);

CREATE TABLE Image (
	Id INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
	Picture VARBINARY(MAX) NOT NULL,
	Alt VARCHAR(50) NOT NULL
);

CREATE TABLE ShopGallery (
	ClothId INT NOT NULL,
	ImageId INT NOT NULL,
	FOREIGN KEY (ClothId)
		REFERENCES Cloth(Id)
		ON UPDATE CASCADE
		ON DELETE CASCADE,
	FOREIGN KEY (ImageId)
		REFERENCES Image(Id)
		ON UPDATE CASCADE
		ON DELETE CASCADE
);

CREATE TABLE EventGallery (
	EventId INT NOT NULL,
	ImageId INT NOT NULL,
	FOREIGN KEY (EventId)
		REFERENCES Event(Id)
		ON UPDATE CASCADE
		ON DELETE CASCADE,
	FOREIGN KEY (ImageId)
		REFERENCES Image(Id)
		ON UPDATE CASCADE
		ON DELETE CASCADE
);